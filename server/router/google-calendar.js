const utils         = require('../utils/utils');
const gcal          = require('../utils/GoogleCalendar');
const datastore     = require('../utils/datastore');

module.exports = (app) => {
    app.all('/calendar/get', utils.ensureAuthenticated, function (req, res) {

        // var mockup = { "kind": "calendar#calendarList", "etag": "\"p334etdksrnauu0g\"", "nextSyncToken": "CMjutpzd1e8CEhdvYW5jZWFpb251dDE1QGdtYWlsLmNvbQ==", "items": [{ "kind": "calendar#calendarListEntry", "etag": "\"1617023384088000\"", "id": "classroom105210657448756981749@group.calendar.google.com", "summary": "PSGBD_CosminVârlan", "timeZone": "UTC", "colorId": "16", "backgroundColor": "#1967d2", "foregroundColor": "#ffffff", "accessRole": "reader", "defaultReminders": [], "conferenceProperties": { "allowedConferenceSolutionTypes": ["hangoutsMeet"] } }, { "kind": "calendar#calendarListEntry", "etag": "\"1617023384845000\"", "id": "ro.romanian#holiday@group.v.calendar.google.com", "summary": "Sărbători în România", "description": "Zile nelucrătoare și sărbători religioase în România", "timeZone": "Europe/Bucharest", "colorId": "7", "backgroundColor": "#42d692", "foregroundColor": "#000000", "accessRole": "reader", "defaultReminders": [], "conferenceProperties": { "allowedConferenceSolutionTypes": ["hangoutsMeet"] } }, { "kind": "calendar#calendarListEntry", "etag": "\"1617023385777000\"", "id": "classroom115113447283526516030@group.calendar.google.com", "summary": "Seminar FAI - Ioana Leahu", "timeZone": "UTC", "colorId": "2", "backgroundColor": "#b80672", "foregroundColor": "#ffffff", "accessRole": "reader", "defaultReminders": [], "conferenceProperties": { "allowedConferenceSolutionTypes": ["hangoutsMeet"] } }, { "kind": "calendar#calendarListEntry", "etag": "\"1617023387178000\"", "id": "addressbook#contacts@group.v.calendar.google.com", "summary": "Birthdays", "description": "Displays birthdays, anniversaries and other event dates of people in Google Contacts.", "timeZone": "Europe/Bucharest", "colorId": "17", "backgroundColor": "#9a9cff", "foregroundColor": "#000000", "accessRole": "reader", "defaultReminders": [], "conferenceProperties": { "allowedConferenceSolutionTypes": ["hangoutsMeet"] } }, { "kind": "calendar#calendarListEntry", "etag": "\"1617028671453000\"", "id": "oanceaionut15@gmail.com", "summary": "oanceaionut15@yahoo.com", "timeZone": "Europe/Bucharest", "colorId": "12", "backgroundColor": "#fad165", "foregroundColor": "#000000", "selected": true, "accessRole": "owner", "defaultReminders": [{ "method": "popup", "minutes": 30 }, { "method": "email", "minutes": 30 }], "notificationSettings": { "notifications": [{ "type": "eventCreation", "method": "email" }, { "type": "eventChange", "method": "email" }, { "type": "eventCancellation", "method": "email" }, { "type": "eventResponse", "method": "email" }] }, "primary": true, "conferenceProperties": { "allowedConferenceSolutionTypes": ["hangoutsMeet"] } }] }
        // res.send(mockup);
        // return;

        var accessToken = req.session.passport.user.accessToken;
        gcal(accessToken).calendarList.list(function (err, data) {
            if (err) return res.send(500, err);
            return res.status(200).send(data);
        });
    });

    app.all('/calendar/get/:calendarId/:email', utils.ensureAuthenticated, function (req, res) {

        // var mockup = {"kind":"calendar#events","etag":"\"p334etdksrnauu0g\"","summary":"oanceaionut15@yahoo.com","updated":"2021-03-29T14:37:51.453Z","timeZone":"Europe/Bucharest","accessRole":"owner","defaultReminders":[{"method":"popup","minutes":30},{"method":"email","minutes":30}],"nextPageToken":"EjYKKzZ1ZWg2Y29hYTNlazRybjZ1MmdqanY3YmVzXzIwMjEwNDA4VDEzMzAwMFoYgOST-Ijv7wIiBwgFEJTN2RI=","items":[{"kind":"calendar#event","etag":"\"3234046389748000\"","id":"6ildtu864di6oa9k6ui5nleq1i","status":"confirmed","htmlLink":"https://www.google.com/calendar/event?eid=NmlsZHR1ODY0ZGk2b2E5azZ1aTVubGVxMWkgb2FuY2VhaW9udXQxNUBt","created":"2021-03-29T13:06:34.000Z","updated":"2021-03-29T13:06:34.874Z","summary":"Ceva","creator":{"email":"oanceaionut15@gmail.com","self":true},"organizer":{"email":"oanceaionut15@gmail.com","self":true},"start":{"dateTime":"2021-03-30T11:30:00+03:00"},"end":{"dateTime":"2021-03-30T12:30:00+03:00"},"iCalUID":"6ildtu864di6oa9k6ui5nleq1i@google.com","sequence":0,"reminders":{"useDefault":true},"eventType":"default"},{"kind":"calendar#event","etag":"\"3234057342192000\"","id":"6ueh6coaa3ek4rn6u2gjjv7bes_20210331T133000Z","status":"confirmed","htmlLink":"https://www.google.com/calendar/event?eid=NnVlaDZjb2FhM2VrNHJuNnUyZ2pqdjdiZXNfMjAyMTAzMzFUMTMzMDAwWiBvYW5jZWFpb251dDE1QG0","created":"2021-03-29T14:37:51.000Z","updated":"2021-03-29T14:37:51.096Z","location":"Terminal 3, Indira Gandhi International Airport, New Delhi, Delhi 110037, India","creator":{"email":"oanceaionut15@gmail.com","self":true},"organizer":{"email":"oanceaionut15@gmail.com","self":true},"start":{"dateTime":"2021-03-31T16:30:00+03:00","timeZone":"Europe/Bucharest"},"end":{"dateTime":"2021-03-31T17:30:00+03:00","timeZone":"Europe/Bucharest"},"recurringEventId":"6ueh6coaa3ek4rn6u2gjjv7bes","originalStartTime":{"dateTime":"2021-03-31T16:30:00+03:00","timeZone":"Europe/Bucharest"},"iCalUID":"6ueh6coaa3ek4rn6u2gjjv7bes@google.com","sequence":0,"reminders":{"useDefault":true},"eventType":"default"},{"kind":"calendar#event","etag":"\"3234057342192000\"","id":"6ueh6coaa3ek4rn6u2gjjv7bes_20210401T133000Z","status":"confirmed","htmlLink":"https://www.google.com/calendar/event?eid=NnVlaDZjb2FhM2VrNHJuNnUyZ2pqdjdiZXNfMjAyMTA0MDFUMTMzMDAwWiBvYW5jZWFpb251dDE1QG0","created":"2021-03-29T14:37:51.000Z","updated":"2021-03-29T14:37:51.096Z","location":"Terminal 3, Indira Gandhi International Airport, New Delhi, Delhi 110037, India","creator":{"email":"oanceaionut15@gmail.com","self":true},"organizer":{"email":"oanceaionut15@gmail.com","self":true},"start":{"dateTime":"2021-04-01T16:30:00+03:00","timeZone":"Europe/Bucharest"},"end":{"dateTime":"2021-04-01T17:30:00+03:00","timeZone":"Europe/Bucharest"},"recurringEventId":"6ueh6coaa3ek4rn6u2gjjv7bes","originalStartTime":{"dateTime":"2021-04-01T16:30:00+03:00","timeZone":"Europe/Bucharest"},"iCalUID":"6ueh6coaa3ek4rn6u2gjjv7bes@google.com","sequence":0,"reminders":{"useDefault":true},"eventType":"default"},{"kind":"calendar#event","etag":"\"3234057342192000\"","id":"6ueh6coaa3ek4rn6u2gjjv7bes_20210402T133000Z","status":"confirmed","htmlLink":"https://www.google.com/calendar/event?eid=NnVlaDZjb2FhM2VrNHJuNnUyZ2pqdjdiZXNfMjAyMTA0MDJUMTMzMDAwWiBvYW5jZWFpb251dDE1QG0","created":"2021-03-29T14:37:51.000Z","updated":"2021-03-29T14:37:51.096Z","location":"Terminal 3, Indira Gandhi International Airport, New Delhi, Delhi 110037, India","creator":{"email":"oanceaionut15@gmail.com","self":true},"organizer":{"email":"oanceaionut15@gmail.com","self":true},"start":{"dateTime":"2021-04-02T16:30:00+03:00","timeZone":"Europe/Bucharest"},"end":{"dateTime":"2021-04-02T17:30:00+03:00","timeZone":"Europe/Bucharest"},"recurringEventId":"6ueh6coaa3ek4rn6u2gjjv7bes","originalStartTime":{"dateTime":"2021-04-02T16:30:00+03:00","timeZone":"Europe/Bucharest"},"iCalUID":"6ueh6coaa3ek4rn6u2gjjv7bes@google.com","sequence":0,"reminders":{"useDefault":true},"eventType":"default"},{"kind":"calendar#event","etag":"\"3234057342192000\"","id":"6ueh6coaa3ek4rn6u2gjjv7bes_20210403T133000Z","status":"confirmed","htmlLink":"https://www.google.com/calendar/event?eid=NnVlaDZjb2FhM2VrNHJuNnUyZ2pqdjdiZXNfMjAyMTA0MDNUMTMzMDAwWiBvYW5jZWFpb251dDE1QG0","created":"2021-03-29T14:37:51.000Z","updated":"2021-03-29T14:37:51.096Z","location":"Terminal 3, Indira Gandhi International Airport, New Delhi, Delhi 110037, India","creator":{"email":"oanceaionut15@gmail.com","self":true},"organizer":{"email":"oanceaionut15@gmail.com","self":true},"start":{"dateTime":"2021-04-03T16:30:00+03:00","timeZone":"Europe/Bucharest"},"end":{"dateTime":"2021-04-03T17:30:00+03:00","timeZone":"Europe/Bucharest"},"recurringEventId":"6ueh6coaa3ek4rn6u2gjjv7bes","originalStartTime":{"dateTime":"2021-04-03T16:30:00+03:00","timeZone":"Europe/Bucharest"},"iCalUID":"6ueh6coaa3ek4rn6u2gjjv7bes@google.com","sequence":0,"reminders":{"useDefault":true},"eventType":"default"},{"kind":"calendar#event","etag":"\"3234057342192000\"","id":"6ueh6coaa3ek4rn6u2gjjv7bes_20210404T133000Z","status":"confirmed","htmlLink":"https://www.google.com/calendar/event?eid=NnVlaDZjb2FhM2VrNHJuNnUyZ2pqdjdiZXNfMjAyMTA0MDRUMTMzMDAwWiBvYW5jZWFpb251dDE1QG0","created":"2021-03-29T14:37:51.000Z","updated":"2021-03-29T14:37:51.096Z","location":"Terminal 3, Indira Gandhi International Airport, New Delhi, Delhi 110037, India","creator":{"email":"oanceaionut15@gmail.com","self":true},"organizer":{"email":"oanceaionut15@gmail.com","self":true},"start":{"dateTime":"2021-04-04T16:30:00+03:00","timeZone":"Europe/Bucharest"},"end":{"dateTime":"2021-04-04T17:30:00+03:00","timeZone":"Europe/Bucharest"},"recurringEventId":"6ueh6coaa3ek4rn6u2gjjv7bes","originalStartTime":{"dateTime":"2021-04-04T16:30:00+03:00","timeZone":"Europe/Bucharest"},"iCalUID":"6ueh6coaa3ek4rn6u2gjjv7bes@google.com","sequence":0,"reminders":{"useDefault":true},"eventType":"default"},{"kind":"calendar#event","etag":"\"3234057342192000\"","id":"6ueh6coaa3ek4rn6u2gjjv7bes_20210405T133000Z","status":"confirmed","htmlLink":"https://www.google.com/calendar/event?eid=NnVlaDZjb2FhM2VrNHJuNnUyZ2pqdjdiZXNfMjAyMTA0MDVUMTMzMDAwWiBvYW5jZWFpb251dDE1QG0","created":"2021-03-29T14:37:51.000Z","updated":"2021-03-29T14:37:51.096Z","location":"Terminal 3, Indira Gandhi International Airport, New Delhi, Delhi 110037, India","creator":{"email":"oanceaionut15@gmail.com","self":true},"organizer":{"email":"oanceaionut15@gmail.com","self":true},"start":{"dateTime":"2021-04-05T16:30:00+03:00","timeZone":"Europe/Bucharest"},"end":{"dateTime":"2021-04-05T17:30:00+03:00","timeZone":"Europe/Bucharest"},"recurringEventId":"6ueh6coaa3ek4rn6u2gjjv7bes","originalStartTime":{"dateTime":"2021-04-05T16:30:00+03:00","timeZone":"Europe/Bucharest"},"iCalUID":"6ueh6coaa3ek4rn6u2gjjv7bes@google.com","sequence":0,"reminders":{"useDefault":true},"eventType":"default"},{"kind":"calendar#event","etag":"\"3234057342192000\"","id":"6ueh6coaa3ek4rn6u2gjjv7bes_20210406T133000Z","status":"confirmed","htmlLink":"https://www.google.com/calendar/event?eid=NnVlaDZjb2FhM2VrNHJuNnUyZ2pqdjdiZXNfMjAyMTA0MDZUMTMzMDAwWiBvYW5jZWFpb251dDE1QG0","created":"2021-03-29T14:37:51.000Z","updated":"2021-03-29T14:37:51.096Z","location":"Terminal 3, Indira Gandhi International Airport, New Delhi, Delhi 110037, India","creator":{"email":"oanceaionut15@gmail.com","self":true},"organizer":{"email":"oanceaionut15@gmail.com","self":true},"start":{"dateTime":"2021-04-06T16:30:00+03:00","timeZone":"Europe/Bucharest"},"end":{"dateTime":"2021-04-06T17:30:00+03:00","timeZone":"Europe/Bucharest"},"recurringEventId":"6ueh6coaa3ek4rn6u2gjjv7bes","originalStartTime":{"dateTime":"2021-04-06T16:30:00+03:00","timeZone":"Europe/Bucharest"},"iCalUID":"6ueh6coaa3ek4rn6u2gjjv7bes@google.com","sequence":0,"reminders":{"useDefault":true},"eventType":"default"},{"kind":"calendar#event","etag":"\"3234057342192000\"","id":"6ueh6coaa3ek4rn6u2gjjv7bes_20210407T133000Z","status":"confirmed","htmlLink":"https://www.google.com/calendar/event?eid=NnVlaDZjb2FhM2VrNHJuNnUyZ2pqdjdiZXNfMjAyMTA0MDdUMTMzMDAwWiBvYW5jZWFpb251dDE1QG0","created":"2021-03-29T14:37:51.000Z","updated":"2021-03-29T14:37:51.096Z","location":"Terminal 3, Indira Gandhi International Airport, New Delhi, Delhi 110037, India","creator":{"email":"oanceaionut15@gmail.com","self":true},"organizer":{"email":"oanceaionut15@gmail.com","self":true},"start":{"dateTime":"2021-04-07T16:30:00+03:00","timeZone":"Europe/Bucharest"},"end":{"dateTime":"2021-04-07T17:30:00+03:00","timeZone":"Europe/Bucharest"},"recurringEventId":"6ueh6coaa3ek4rn6u2gjjv7bes","originalStartTime":{"dateTime":"2021-04-07T16:30:00+03:00","timeZone":"Europe/Bucharest"},"iCalUID":"6ueh6coaa3ek4rn6u2gjjv7bes@google.com","sequence":0,"reminders":{"useDefault":true},"eventType":"default"},{"kind":"calendar#event","etag":"\"3234057342192000\"","id":"6ueh6coaa3ek4rn6u2gjjv7bes_20210408T133000Z","status":"confirmed","htmlLink":"https://www.google.com/calendar/event?eid=NnVlaDZjb2FhM2VrNHJuNnUyZ2pqdjdiZXNfMjAyMTA0MDhUMTMzMDAwWiBvYW5jZWFpb251dDE1QG0","created":"2021-03-29T14:37:51.000Z","updated":"2021-03-29T14:37:51.096Z","location":"Terminal 3, Indira Gandhi International Airport, New Delhi, Delhi 110037, India","creator":{"email":"oanceaionut15@gmail.com","self":true},"organizer":{"email":"oanceaionut15@gmail.com","self":true},"start":{"dateTime":"2021-04-08T16:30:00+03:00","timeZone":"Europe/Bucharest"},"end":{"dateTime":"2021-04-08T17:30:00+03:00","timeZone":"Europe/Bucharest"},"recurringEventId":"6ueh6coaa3ek4rn6u2gjjv7bes","originalStartTime":{"dateTime":"2021-04-08T16:30:00+03:00","timeZone":"Europe/Bucharest"},"iCalUID":"6ueh6coaa3ek4rn6u2gjjv7bes@google.com","sequence":0,"reminders":{"useDefault":true},"eventType":"default"}]}
        // res.send(mockup);
        // return;

        if(req.params.email === 'self'){ req.params.email = req.user.email; }

        var accessToken = req.session.passport.user.accessToken;
        var calendarId = req.params.calendarId;

        gcal(accessToken).events.list(calendarId, {
            maxResults: 50,
            timeMin: (new Date()).toISOString(),
            singleEvents: true,
            orderBy: 'startTime'
        }, function (err, data) {
            if (err) return res.send(500, err);
            if (data.nextPageToken) {
                gcal(accessToken).events.list(calendarId, { maxResults: 50, pageToken: data.nextPageToken }, function (err, data) {})
            }
            datastore.storeCalendar(req.params.email,data);
            return res.status(200).send(data);
        });
    });
    app.all('/calendar/get_user/:email', utils.ensureAuthenticated, async function (req, res) {

        // var mockup = {"kind":"calendar#events","etag":"\"p334etdksrnauu0g\"","summary":"oanceaionut15@yahoo.com","updated":"2021-03-29T14:37:51.453Z","timeZone":"Europe/Bucharest","accessRole":"owner","defaultReminders":[{"method":"popup","minutes":30},{"method":"email","minutes":30}],"nextPageToken":"EjYKKzZ1ZWg2Y29hYTNlazRybjZ1MmdqanY3YmVzXzIwMjEwNDA4VDEzMzAwMFoYgOST-Ijv7wIiBwgFEJTN2RI=","items":[{"kind":"calendar#event","etag":"\"3234046389748000\"","id":"6ildtu864di6oa9k6ui5nleq1i","status":"confirmed","htmlLink":"https://www.google.com/calendar/event?eid=NmlsZHR1ODY0ZGk2b2E5azZ1aTVubGVxMWkgb2FuY2VhaW9udXQxNUBt","created":"2021-03-29T13:06:34.000Z","updated":"2021-03-29T13:06:34.874Z","summary":"Ceva","creator":{"email":"oanceaionut15@gmail.com","self":true},"organizer":{"email":"oanceaionut15@gmail.com","self":true},"start":{"dateTime":"2021-03-30T11:30:00+03:00"},"end":{"dateTime":"2021-03-30T12:30:00+03:00"},"iCalUID":"6ildtu864di6oa9k6ui5nleq1i@google.com","sequence":0,"reminders":{"useDefault":true},"eventType":"default"},{"kind":"calendar#event","etag":"\"3234057342192000\"","id":"6ueh6coaa3ek4rn6u2gjjv7bes_20210331T133000Z","status":"confirmed","htmlLink":"https://www.google.com/calendar/event?eid=NnVlaDZjb2FhM2VrNHJuNnUyZ2pqdjdiZXNfMjAyMTAzMzFUMTMzMDAwWiBvYW5jZWFpb251dDE1QG0","created":"2021-03-29T14:37:51.000Z","updated":"2021-03-29T14:37:51.096Z","location":"Terminal 3, Indira Gandhi International Airport, New Delhi, Delhi 110037, India","creator":{"email":"oanceaionut15@gmail.com","self":true},"organizer":{"email":"oanceaionut15@gmail.com","self":true},"start":{"dateTime":"2021-03-31T16:30:00+03:00","timeZone":"Europe/Bucharest"},"end":{"dateTime":"2021-03-31T17:30:00+03:00","timeZone":"Europe/Bucharest"},"recurringEventId":"6ueh6coaa3ek4rn6u2gjjv7bes","originalStartTime":{"dateTime":"2021-03-31T16:30:00+03:00","timeZone":"Europe/Bucharest"},"iCalUID":"6ueh6coaa3ek4rn6u2gjjv7bes@google.com","sequence":0,"reminders":{"useDefault":true},"eventType":"default"},{"kind":"calendar#event","etag":"\"3234057342192000\"","id":"6ueh6coaa3ek4rn6u2gjjv7bes_20210401T133000Z","status":"confirmed","htmlLink":"https://www.google.com/calendar/event?eid=NnVlaDZjb2FhM2VrNHJuNnUyZ2pqdjdiZXNfMjAyMTA0MDFUMTMzMDAwWiBvYW5jZWFpb251dDE1QG0","created":"2021-03-29T14:37:51.000Z","updated":"2021-03-29T14:37:51.096Z","location":"Terminal 3, Indira Gandhi International Airport, New Delhi, Delhi 110037, India","creator":{"email":"oanceaionut15@gmail.com","self":true},"organizer":{"email":"oanceaionut15@gmail.com","self":true},"start":{"dateTime":"2021-04-01T16:30:00+03:00","timeZone":"Europe/Bucharest"},"end":{"dateTime":"2021-04-01T17:30:00+03:00","timeZone":"Europe/Bucharest"},"recurringEventId":"6ueh6coaa3ek4rn6u2gjjv7bes","originalStartTime":{"dateTime":"2021-04-01T16:30:00+03:00","timeZone":"Europe/Bucharest"},"iCalUID":"6ueh6coaa3ek4rn6u2gjjv7bes@google.com","sequence":0,"reminders":{"useDefault":true},"eventType":"default"},{"kind":"calendar#event","etag":"\"3234057342192000\"","id":"6ueh6coaa3ek4rn6u2gjjv7bes_20210402T133000Z","status":"confirmed","htmlLink":"https://www.google.com/calendar/event?eid=NnVlaDZjb2FhM2VrNHJuNnUyZ2pqdjdiZXNfMjAyMTA0MDJUMTMzMDAwWiBvYW5jZWFpb251dDE1QG0","created":"2021-03-29T14:37:51.000Z","updated":"2021-03-29T14:37:51.096Z","location":"Terminal 3, Indira Gandhi International Airport, New Delhi, Delhi 110037, India","creator":{"email":"oanceaionut15@gmail.com","self":true},"organizer":{"email":"oanceaionut15@gmail.com","self":true},"start":{"dateTime":"2021-04-02T16:30:00+03:00","timeZone":"Europe/Bucharest"},"end":{"dateTime":"2021-04-02T17:30:00+03:00","timeZone":"Europe/Bucharest"},"recurringEventId":"6ueh6coaa3ek4rn6u2gjjv7bes","originalStartTime":{"dateTime":"2021-04-02T16:30:00+03:00","timeZone":"Europe/Bucharest"},"iCalUID":"6ueh6coaa3ek4rn6u2gjjv7bes@google.com","sequence":0,"reminders":{"useDefault":true},"eventType":"default"},{"kind":"calendar#event","etag":"\"3234057342192000\"","id":"6ueh6coaa3ek4rn6u2gjjv7bes_20210403T133000Z","status":"confirmed","htmlLink":"https://www.google.com/calendar/event?eid=NnVlaDZjb2FhM2VrNHJuNnUyZ2pqdjdiZXNfMjAyMTA0MDNUMTMzMDAwWiBvYW5jZWFpb251dDE1QG0","created":"2021-03-29T14:37:51.000Z","updated":"2021-03-29T14:37:51.096Z","location":"Terminal 3, Indira Gandhi International Airport, New Delhi, Delhi 110037, India","creator":{"email":"oanceaionut15@gmail.com","self":true},"organizer":{"email":"oanceaionut15@gmail.com","self":true},"start":{"dateTime":"2021-04-03T16:30:00+03:00","timeZone":"Europe/Bucharest"},"end":{"dateTime":"2021-04-03T17:30:00+03:00","timeZone":"Europe/Bucharest"},"recurringEventId":"6ueh6coaa3ek4rn6u2gjjv7bes","originalStartTime":{"dateTime":"2021-04-03T16:30:00+03:00","timeZone":"Europe/Bucharest"},"iCalUID":"6ueh6coaa3ek4rn6u2gjjv7bes@google.com","sequence":0,"reminders":{"useDefault":true},"eventType":"default"},{"kind":"calendar#event","etag":"\"3234057342192000\"","id":"6ueh6coaa3ek4rn6u2gjjv7bes_20210404T133000Z","status":"confirmed","htmlLink":"https://www.google.com/calendar/event?eid=NnVlaDZjb2FhM2VrNHJuNnUyZ2pqdjdiZXNfMjAyMTA0MDRUMTMzMDAwWiBvYW5jZWFpb251dDE1QG0","created":"2021-03-29T14:37:51.000Z","updated":"2021-03-29T14:37:51.096Z","location":"Terminal 3, Indira Gandhi International Airport, New Delhi, Delhi 110037, India","creator":{"email":"oanceaionut15@gmail.com","self":true},"organizer":{"email":"oanceaionut15@gmail.com","self":true},"start":{"dateTime":"2021-04-04T16:30:00+03:00","timeZone":"Europe/Bucharest"},"end":{"dateTime":"2021-04-04T17:30:00+03:00","timeZone":"Europe/Bucharest"},"recurringEventId":"6ueh6coaa3ek4rn6u2gjjv7bes","originalStartTime":{"dateTime":"2021-04-04T16:30:00+03:00","timeZone":"Europe/Bucharest"},"iCalUID":"6ueh6coaa3ek4rn6u2gjjv7bes@google.com","sequence":0,"reminders":{"useDefault":true},"eventType":"default"},{"kind":"calendar#event","etag":"\"3234057342192000\"","id":"6ueh6coaa3ek4rn6u2gjjv7bes_20210405T133000Z","status":"confirmed","htmlLink":"https://www.google.com/calendar/event?eid=NnVlaDZjb2FhM2VrNHJuNnUyZ2pqdjdiZXNfMjAyMTA0MDVUMTMzMDAwWiBvYW5jZWFpb251dDE1QG0","created":"2021-03-29T14:37:51.000Z","updated":"2021-03-29T14:37:51.096Z","location":"Terminal 3, Indira Gandhi International Airport, New Delhi, Delhi 110037, India","creator":{"email":"oanceaionut15@gmail.com","self":true},"organizer":{"email":"oanceaionut15@gmail.com","self":true},"start":{"dateTime":"2021-04-05T16:30:00+03:00","timeZone":"Europe/Bucharest"},"end":{"dateTime":"2021-04-05T17:30:00+03:00","timeZone":"Europe/Bucharest"},"recurringEventId":"6ueh6coaa3ek4rn6u2gjjv7bes","originalStartTime":{"dateTime":"2021-04-05T16:30:00+03:00","timeZone":"Europe/Bucharest"},"iCalUID":"6ueh6coaa3ek4rn6u2gjjv7bes@google.com","sequence":0,"reminders":{"useDefault":true},"eventType":"default"},{"kind":"calendar#event","etag":"\"3234057342192000\"","id":"6ueh6coaa3ek4rn6u2gjjv7bes_20210406T133000Z","status":"confirmed","htmlLink":"https://www.google.com/calendar/event?eid=NnVlaDZjb2FhM2VrNHJuNnUyZ2pqdjdiZXNfMjAyMTA0MDZUMTMzMDAwWiBvYW5jZWFpb251dDE1QG0","created":"2021-03-29T14:37:51.000Z","updated":"2021-03-29T14:37:51.096Z","location":"Terminal 3, Indira Gandhi International Airport, New Delhi, Delhi 110037, India","creator":{"email":"oanceaionut15@gmail.com","self":true},"organizer":{"email":"oanceaionut15@gmail.com","self":true},"start":{"dateTime":"2021-04-06T16:30:00+03:00","timeZone":"Europe/Bucharest"},"end":{"dateTime":"2021-04-06T17:30:00+03:00","timeZone":"Europe/Bucharest"},"recurringEventId":"6ueh6coaa3ek4rn6u2gjjv7bes","originalStartTime":{"dateTime":"2021-04-06T16:30:00+03:00","timeZone":"Europe/Bucharest"},"iCalUID":"6ueh6coaa3ek4rn6u2gjjv7bes@google.com","sequence":0,"reminders":{"useDefault":true},"eventType":"default"},{"kind":"calendar#event","etag":"\"3234057342192000\"","id":"6ueh6coaa3ek4rn6u2gjjv7bes_20210407T133000Z","status":"confirmed","htmlLink":"https://www.google.com/calendar/event?eid=NnVlaDZjb2FhM2VrNHJuNnUyZ2pqdjdiZXNfMjAyMTA0MDdUMTMzMDAwWiBvYW5jZWFpb251dDE1QG0","created":"2021-03-29T14:37:51.000Z","updated":"2021-03-29T14:37:51.096Z","location":"Terminal 3, Indira Gandhi International Airport, New Delhi, Delhi 110037, India","creator":{"email":"oanceaionut15@gmail.com","self":true},"organizer":{"email":"oanceaionut15@gmail.com","self":true},"start":{"dateTime":"2021-04-07T16:30:00+03:00","timeZone":"Europe/Bucharest"},"end":{"dateTime":"2021-04-07T17:30:00+03:00","timeZone":"Europe/Bucharest"},"recurringEventId":"6ueh6coaa3ek4rn6u2gjjv7bes","originalStartTime":{"dateTime":"2021-04-07T16:30:00+03:00","timeZone":"Europe/Bucharest"},"iCalUID":"6ueh6coaa3ek4rn6u2gjjv7bes@google.com","sequence":0,"reminders":{"useDefault":true},"eventType":"default"},{"kind":"calendar#event","etag":"\"3234057342192000\"","id":"6ueh6coaa3ek4rn6u2gjjv7bes_20210408T133000Z","status":"confirmed","htmlLink":"https://www.google.com/calendar/event?eid=NnVlaDZjb2FhM2VrNHJuNnUyZ2pqdjdiZXNfMjAyMTA0MDhUMTMzMDAwWiBvYW5jZWFpb251dDE1QG0","created":"2021-03-29T14:37:51.000Z","updated":"2021-03-29T14:37:51.096Z","location":"Terminal 3, Indira Gandhi International Airport, New Delhi, Delhi 110037, India","creator":{"email":"oanceaionut15@gmail.com","self":true},"organizer":{"email":"oanceaionut15@gmail.com","self":true},"start":{"dateTime":"2021-04-08T16:30:00+03:00","timeZone":"Europe/Bucharest"},"end":{"dateTime":"2021-04-08T17:30:00+03:00","timeZone":"Europe/Bucharest"},"recurringEventId":"6ueh6coaa3ek4rn6u2gjjv7bes","originalStartTime":{"dateTime":"2021-04-08T16:30:00+03:00","timeZone":"Europe/Bucharest"},"iCalUID":"6ueh6coaa3ek4rn6u2gjjv7bes@google.com","sequence":0,"reminders":{"useDefault":true},"eventType":"default"}]}
        // res.send(mockup);
        // return;
        
        var data = await datastore.getCalendar(req.params.email,data);
        return res.status(200).send(data[0][0]);
    })
}